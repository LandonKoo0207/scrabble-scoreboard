<h1>Scrabble Scoreboard</h1>

<% if @scrabble.num_of_players < 2 %>
  There must be at least 2 players. Create more players.
<% elsif @scrabble.num_of_players == 2 %>
  <% player_scoreboard_width = "col-sm-6" %>
<% elsif @scrabble.num_of_players == 3 %>
  <% player_scoreboard_width = "col-sm-4" %>
<% else %>
  <% player_scoreboard_width = "col-sm-3" %>
<% end %>

<%= render template: 'words/new' %>

<div>
  <h2>Leaderboard</h2>
  <% @scrabble.players.sort_by { |player| player.words.pluck(:score).sum }.reverse.each_with_index do |player, index| %>
    <div>
      <%= index+1 %> <%= player.name %> (<%= player.words.pluck(:score).sum %>)
    </div>
  <% end %>
</div>

<hr>

<div class="row">
<% @scrabble.players.each do |player| %>
  <div class="<%= player_scoreboard_width %>">Turn 
    <%= player.turn %>: <%= player.name %> (<%= player.words.pluck(:score).sum %>)
  </div>
<% end %>
</div>

<div class="row">
<!--
<% @scrabble.players.each do |player| %>
  <div class="<%= player_scoreboard_width %>">
  <% player.words.each do |word| %>
    <% if Word.exists? %>
      <%= word.word %> <%= word.double_letter.count %>, <%= word.score %>
    <% end %>
  <br>
  <% end %>
<% end %>
-->
<div class="<%= player_scoreboard_width %>">
<% @scrabble.players.first.words.each do |word| %>
  <% if Word.exists? %>
    <%= word.word %> <%= word.double_letter.count %>, <%= word.score %>
  <% end %>
  <br>
<% end %>
</div>
<div class="<%= player_scoreboard_width %>">
<% @scrabble.players.second.words.each do |word| %>
  <% if Word.exists? %>
    <%= word.word %> <%= word.double_letter.count %>, <%= word.score %>
  <% end %>
  <br>
<% end %>
</div>

<% if @scrabble.num_of_players >= 3 %>
  <div class="<%= player_scoreboard_width %>">
  <% @scrabble.players.third.words.each do |word| %>
    <% if Word.exists? %>
      <%= word.word %> <%= word.double_letter.count %>, <%= word.score %>
    <% end %>
    <br>
  <% end %>
  </div>
  <% if @scrabble.num_of_players == 4 %>
    <div class="<%= player_scoreboard_width %>">
    <% @scrabble.players.fourth.words.each do |word| %>
      <% if Word.exists? %>
        <%= word.word %> <%= word.double_letter.count %>, <%= word.score %>
      <% end %>
      <br>
    <% end %>
    </div>
  <% end %>
<% end %>

</div>
<hr>
<%= link_to 'Home', root_path %>
